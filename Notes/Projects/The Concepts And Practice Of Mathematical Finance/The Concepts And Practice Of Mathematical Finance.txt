OK might get around to doing this in relatively performant C++ soon.
